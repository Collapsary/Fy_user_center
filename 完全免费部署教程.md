# ðŸ†“ å®Œå…¨å…è´¹éƒ¨ç½²æ•™ç¨‹ - ç”¨æˆ·ç®¡ç†ç³»ç»Ÿ

## ðŸŽ¯ å…è´¹éƒ¨ç½²æ–¹æ¡ˆæ¦‚è§ˆ

### æ–¹æ¡ˆä¸€ï¼šDocker + å…è´¹äº‘æœåŠ¡å™¨ï¼ˆæŽ¨èï¼‰âœ…
- **æœåŠ¡å™¨**ï¼šOracle Cloudï¼ˆæ°¸ä¹…å…è´¹ï¼‰
- **æ•°æ®åº“**ï¼šDocker MySQL
- **åŽç«¯**ï¼šDocker Spring Boot
- **å‰ç«¯**ï¼šVercelï¼ˆå…è´¹ï¼‰

### æ–¹æ¡ˆäºŒï¼šå®å¡”é¢æ¿ + å…è´¹äº‘æœåŠ¡å™¨
- **æœåŠ¡å™¨**ï¼šOracle Cloudï¼ˆæ°¸ä¹…å…è´¹ï¼‰
- **é¢æ¿**ï¼šå®å¡”Linuxé¢æ¿ï¼ˆå…è´¹ç‰ˆï¼‰
- **æ•°æ®åº“**ï¼šMySQL
- **åŽç«¯**ï¼šJavaåº”ç”¨
- **å‰ç«¯**ï¼šVercelï¼ˆå…è´¹ï¼‰

### æ–¹æ¡ˆä¸‰ï¼šRailway + Vercelï¼ˆæœ€ç®€å•ï¼‰
- **åŽç«¯**ï¼šRailwayï¼ˆå…è´¹é¢åº¦ï¼‰
- **æ•°æ®åº“**ï¼šRailway MySQLï¼ˆå…è´¹é¢åº¦ï¼‰
- **å‰ç«¯**ï¼šVercelï¼ˆå…è´¹ï¼‰

## ðŸš€ æ–¹æ¡ˆä¸€ï¼šDockeréƒ¨ç½²ï¼ˆæŽ¨èï¼‰

### ç¬¬ä¸€æ­¥ï¼šç”³è¯·Oracle Cloudå…è´¹æœåŠ¡å™¨

#### 1.1 æ³¨å†ŒOracle Cloud
1. è®¿é—® [Oracle Cloud](https://www.oracle.com/cloud/free/)
2. ç‚¹å‡» **"Start for free"**
3. å¡«å†™æ³¨å†Œä¿¡æ¯
4. éªŒè¯é‚®ç®±å’Œæ‰‹æœºå·
5. ç­‰å¾…å®¡æ ¸é€šè¿‡ï¼ˆé€šå¸¸1-2å¤©ï¼‰

#### 1.2 åˆ›å»ºå…è´¹å®žä¾‹
1. ç™»å½•Oracle CloudæŽ§åˆ¶å°
2. ç‚¹å‡» **"Create a VM instance"**
3. é€‰æ‹©é…ç½®ï¼š
   - **Image**: Oracle Linux 8
   - **Shape**: VM.Standard.E2.1.Microï¼ˆæ°¸ä¹…å…è´¹ï¼‰
   - **SSH Key**: ç”Ÿæˆæˆ–ä¸Šä¼ SSHå¯†é’¥
4. ç‚¹å‡» **"Create"**
5. ç­‰å¾…å®žä¾‹åˆ›å»ºå®Œæˆ

#### 1.3 é…ç½®å®‰å…¨ç»„
1. è¿›å…¥å®žä¾‹è¯¦æƒ…
2. ç‚¹å‡» **"Security Lists"**
3. æ·»åŠ å…¥ç«™è§„åˆ™ï¼š
   - **Source**: 0.0.0.0/0
   - **IP Protocol**: TCP
   - **Destination Port Range**: 22, 80, 443, 8080, 3306

### ç¬¬äºŒæ­¥ï¼šå®‰è£…DockerçŽ¯å¢ƒ

#### 2.1 è¿žæŽ¥æœåŠ¡å™¨
```bash
ssh opc@your-server-ip
```

#### 2.2 å®‰è£…Docker
```bash
# æ›´æ–°ç³»ç»Ÿ
sudo yum update -y

# å®‰è£…Docker
sudo yum install -y docker

# å¯åŠ¨DockeræœåŠ¡
sudo systemctl start docker
sudo systemctl enable docker

# å°†å½“å‰ç”¨æˆ·æ·»åŠ åˆ°dockerç»„
sudo usermod -aG docker opc

# é‡æ–°ç™»å½•æˆ–æ‰§è¡Œ
newgrp docker

# éªŒè¯å®‰è£…
docker --version
```

#### 2.3 å®‰è£…Docker Compose
```bash
# ä¸‹è½½Docker Compose
sudo curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

# æ·»åŠ æ‰§è¡Œæƒé™
sudo chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker-compose --version
```

### ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºDockeré…ç½®æ–‡ä»¶

#### 3.1 åˆ›å»ºé¡¹ç›®ç›®å½•
```bash
mkdir -p /home/opc/user-center
cd /home/opc/user-center
```

#### 3.2 åˆ›å»ºDocker Composeæ–‡ä»¶
```yaml
# docker-compose.yml
version: '3.8'

services:
  mysql:
    image: mysql:8.0
    container_name: user-center-mysql
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: root123456
      MYSQL_DATABASE: user_center
      MYSQL_USER: usercenter
      MYSQL_PASSWORD: user123456
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    command: --default-authentication-plugin=mysql_native_password

  backend:
    image: openjdk:8-jre-alpine
    container_name: user-center-backend
    restart: always
    ports:
      - "8080:8080"
    volumes:
      - ./app.jar:/app/app.jar
      - ./application-prod.yml:/app/application-prod.yml
    depends_on:
      - mysql
    command: java -jar /app/app.jar --spring.config.location=/app/application-prod.yml

volumes:
  mysql_data:
```

#### 3.3 åˆ›å»ºæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
```sql
-- init.sql
CREATE DATABASE IF NOT EXISTS user_center CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;

USE user_center;

CREATE TABLE IF NOT EXISTS user (
    id bigint NOT NULL AUTO_INCREMENT COMMENT 'id',
    username varchar(256) DEFAULT NULL COMMENT 'ç”¨æˆ·æ˜µç§°',
    userAccount varchar(256) NOT NULL COMMENT 'è´¦å·',
    avatarUrl varchar(1024) DEFAULT NULL COMMENT 'ç”¨æˆ·å¤´åƒ',
    gender tinyint DEFAULT NULL COMMENT 'æ€§åˆ«',
    userPassword varchar(512) NOT NULL COMMENT 'å¯†ç ',
    phone varchar(128) DEFAULT NULL COMMENT 'ç”µè¯',
    email varchar(512) DEFAULT NULL COMMENT 'é‚®ç®±',
    userStatus int NOT NULL DEFAULT '0' COMMENT 'çŠ¶æ€ 0 - æ­£å¸¸',
    createTime datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    updateTime datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    isDelete tinyint NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦åˆ é™¤',
    userRole int NOT NULL DEFAULT '0' COMMENT 'ç”¨æˆ·è§’è‰² 0 - æ™®é€šç”¨æˆ· 1 - ç®¡ç†å‘˜',
    planetCode varchar(512) DEFAULT NULL COMMENT 'æ˜Ÿçƒç¼–å·',
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT='ç”¨æˆ·';
```

#### 3.4 åˆ›å»ºç”Ÿäº§çŽ¯å¢ƒé…ç½®
```yaml
# application-prod.yml
server:
  port: 8080

spring:
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://mysql:3306/user_center?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai
    username: usercenter
    password: user123456
  profiles:
    active: prod

mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      logic-delete-field: isDelete
      logic-delete-value: 1
      logic-not-delete-value: 0

logging:
  level:
    com.fy.usercenter: INFO
    org.springframework: WARN
```

### ç¬¬å››æ­¥ï¼šæž„å»ºå’Œéƒ¨ç½²

#### 4.1 æž„å»ºåŽç«¯åº”ç”¨
```bash
# åœ¨æœ¬åœ°æ‰§è¡Œ
cd back/FioonYang-center
mvn clean package -DskipTests

# ä¸Šä¼ jaråŒ…åˆ°æœåŠ¡å™¨
scp target/*.jar opc@your-server-ip:/home/opc/user-center/app.jar
```

#### 4.2 ä¸Šä¼ é…ç½®æ–‡ä»¶
```bash
# ä¸Šä¼ é…ç½®æ–‡ä»¶
scp application-prod.yml opc@your-server-ip:/home/opc/user-center/
scp init.sql opc@your-server-ip:/home/opc/user-center/
scp docker-compose.yml opc@your-server-ip:/home/opc/user-center/
```

#### 4.3 å¯åŠ¨æœåŠ¡
```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
cd /home/opc/user-center
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

### ç¬¬äº”æ­¥ï¼šéƒ¨ç½²å‰ç«¯åˆ°Vercel

#### 5.1 ä¿®æ”¹å‰ç«¯é…ç½®
```typescript
// front/user-center-frontend-master/src/plugins/globalRequest.ts
const request = extend({
  credentials: 'include',
  prefix: process.env.NODE_ENV === 'production' 
    ? process.env.REACT_APP_API_URL || 'http://your-server-ip:8080' 
    : 'http://localhost:8080',
  timeout: 10000,
});
```

#### 5.2 éƒ¨ç½²åˆ°Vercel
1. è®¿é—® [Vercel](https://vercel.com/)
2. è¿žæŽ¥Giteeä»“åº“
3. é€‰æ‹©å‰ç«¯ç›®å½•
4. é…ç½®çŽ¯å¢ƒå˜é‡ï¼š
   ```
   NODE_ENV=production
   REACT_APP_API_URL=http://your-server-ip:8080
   ```

## ðŸš€ æ–¹æ¡ˆäºŒï¼šå®å¡”é¢æ¿éƒ¨ç½²

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…å®å¡”é¢æ¿

#### 1.1 å®‰è£…å®å¡”Linuxé¢æ¿
```bash
# åœ¨Oracle CloudæœåŠ¡å™¨ä¸Šæ‰§è¡Œ
wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh ed8484bec
```

#### 1.2 é…ç½®å®å¡”é¢æ¿
1. å®‰è£…å®ŒæˆåŽï¼Œè®°å½•é¢æ¿åœ°å€å’Œè´¦å·å¯†ç 
2. åœ¨æµè§ˆå™¨ä¸­è®¿é—®é¢æ¿åœ°å€
3. ç™»å½•é¢æ¿

#### 1.3 å®‰è£…å¿…è¦è½¯ä»¶
åœ¨å®å¡”é¢æ¿ä¸­å®‰è£…ï¼š
- **Nginx** 1.20
- **MySQL** 8.0
- **Java** 8
- **Maven** 3.8

### ç¬¬äºŒæ­¥ï¼šé…ç½®æ•°æ®åº“

#### 2.1 åˆ›å»ºæ•°æ®åº“
1. åœ¨å®å¡”é¢æ¿ç‚¹å‡» **"æ•°æ®åº“"**
2. ç‚¹å‡» **"æ·»åŠ æ•°æ®åº“"**
3. è®¾ç½®ï¼š
   - **æ•°æ®åº“å**: user_center
   - **ç”¨æˆ·å**: usercenter
   - **å¯†ç **: user123456
4. ç‚¹å‡» **"æäº¤"**

#### 2.2 å¯¼å…¥æ•°æ®åº“ç»“æž„
1. ç‚¹å‡»æ•°æ®åº“åŽçš„ **"ç®¡ç†"**
2. è¿›å…¥phpMyAdmin
3. å¯¼å…¥æ•°æ®åº“ç»“æž„ï¼ˆä½¿ç”¨ä¸Šé¢çš„init.sqlï¼‰

### ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²åŽç«¯

#### 3.1 ä¸Šä¼ ä»£ç 
1. åœ¨å®å¡”é¢æ¿ç‚¹å‡» **"æ–‡ä»¶"**
2. è¿›å…¥ `/www/wwwroot/` ç›®å½•
3. åˆ›å»º `user-center` ç›®å½•
4. ä¸Šä¼ åŽç«¯ä»£ç 

#### 3.2 æž„å»ºåº”ç”¨
```bash
# åœ¨å®å¡”ç»ˆç«¯ä¸­æ‰§è¡Œ
cd /www/wwwroot/user-center/back/FioonYang-center
mvn clean package -DskipTests
```

#### 3.3 é…ç½®å¯åŠ¨è„šæœ¬
```bash
# åˆ›å»ºå¯åŠ¨è„šæœ¬
cat > /www/wwwroot/user-center/start.sh << EOF
#!/bin/bash
cd /www/wwwroot/user-center/back/FioonYang-center
java -jar target/*.jar --spring.profiles.active=prod
EOF

chmod +x /www/wwwroot/user-center/start.sh
```

#### 3.4 é…ç½®PM2ç®¡ç†
1. åœ¨å®å¡”é¢æ¿å®‰è£… **PM2ç®¡ç†å™¨**
2. æ·»åŠ æ–°é¡¹ç›®ï¼š
   - **é¡¹ç›®åç§°**: user-center-backend
   - **è¿è¡Œç›®å½•**: /www/wwwroot/user-center/back/FioonYang-center
   - **å¯åŠ¨æ–‡ä»¶**: start.sh
   - **ç«¯å£**: 8080

### ç¬¬å››æ­¥ï¼šé…ç½®Nginxåå‘ä»£ç†

#### 4.1 åˆ›å»ºNginxé…ç½®
```nginx
# /www/server/panel/vhost/nginx/user-center.conf
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

#### 4.2 é‡å¯Nginx
```bash
nginx -s reload
```

## ðŸš€ æ–¹æ¡ˆä¸‰ï¼šRailwayéƒ¨ç½²ï¼ˆæœ€ç®€å•ï¼‰

### ç¬¬ä¸€æ­¥ï¼šæ³¨å†ŒRailway
1. è®¿é—® [Railway](https://railway.app/)
2. ä½¿ç”¨GitHubè´¦å·ç™»å½•
3. è¿žæŽ¥GitHubä»“åº“

### ç¬¬äºŒæ­¥ï¼šéƒ¨ç½²åŽç«¯
1. åœ¨Railwayåˆ›å»ºæ–°é¡¹ç›®
2. é€‰æ‹© **"Deploy from GitHub repo"**
3. é€‰æ‹©æ‚¨çš„ä»“åº“
4. è®¾ç½®æž„å»ºç›®å½•ï¼š`back/FioonYang-center`
5. é…ç½®çŽ¯å¢ƒå˜é‡ï¼š
   ```
   SPRING_PROFILES_ACTIVE=prod
   MYSQL_HOST=mysql
   MYSQL_PORT=3306
   MYSQL_DATABASE=user_center
   MYSQL_USER=usercenter
   MYSQL_PASSWORD=user123456
   ```

### ç¬¬ä¸‰æ­¥ï¼šéƒ¨ç½²æ•°æ®åº“
1. åœ¨Railwayæ·»åŠ MySQLæœåŠ¡
2. é…ç½®æ•°æ®åº“è¿žæŽ¥
3. å¯¼å…¥æ•°æ®åº“ç»“æž„

### ç¬¬å››æ­¥ï¼šéƒ¨ç½²å‰ç«¯
1. ä½¿ç”¨Verceléƒ¨ç½²å‰ç«¯
2. é…ç½®APIåœ°å€æŒ‡å‘RailwayåŽç«¯

## ðŸ’° è´¹ç”¨å¯¹æ¯”

| æ–¹æ¡ˆ | æœåŠ¡å™¨ | æ•°æ®åº“ | å‰ç«¯ | æ€»è´¹ç”¨ |
|------|--------|--------|------|--------|
| Docker + Oracle | å…è´¹ | å…è´¹ | å…è´¹ | **0å…ƒ/æœˆ** |
| å®å¡” + Oracle | å…è´¹ | å…è´¹ | å…è´¹ | **0å…ƒ/æœˆ** |
| Railway + Vercel | å…è´¹é¢åº¦ | å…è´¹é¢åº¦ | å…è´¹ | **0å…ƒ/æœˆ** |

## ðŸŽ¯ æŽ¨èæ–¹æ¡ˆ

### å¯¹äºŽåˆå­¦è€…ï¼šRailway + Vercel
- âœ… æœ€ç®€å•
- âœ… æ— éœ€æœåŠ¡å™¨ç®¡ç†
- âœ… è‡ªåŠ¨éƒ¨ç½²
- âœ… å®Œå…¨å…è´¹

### å¯¹äºŽæœ‰ç»éªŒè€…ï¼šDocker + Oracle
- âœ… å®Œå…¨æŽ§åˆ¶
- âœ… æ€§èƒ½æœ€å¥½
- âœ… æ°¸ä¹…å…è´¹
- âœ… å­¦ä¹ ä»·å€¼é«˜

## ðŸš€ å¿«é€Ÿå¼€å§‹

### é€‰æ‹©Railwayæ–¹æ¡ˆï¼ˆæŽ¨èæ–°æ‰‹ï¼‰
1. æ³¨å†ŒRailwayè´¦å·
2. è¿žæŽ¥GitHubä»“åº“
3. éƒ¨ç½²åŽç«¯å’Œæ•°æ®åº“
4. ä½¿ç”¨Verceléƒ¨ç½²å‰ç«¯
5. **é¢„è®¡30åˆ†é’Ÿå®Œæˆ**

### é€‰æ‹©Dockeræ–¹æ¡ˆï¼ˆæŽ¨èæœ‰ç»éªŒè€…ï¼‰
1. ç”³è¯·Oracle Cloudå…è´¹æœåŠ¡å™¨
2. å®‰è£…DockerçŽ¯å¢ƒ
3. éƒ¨ç½²åŽç«¯å’Œæ•°æ®åº“
4. ä½¿ç”¨Verceléƒ¨ç½²å‰ç«¯
5. **é¢„è®¡2å°æ—¶å®Œæˆ**

## ðŸ†˜ æŠ€æœ¯æ”¯æŒ

å¦‚æžœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£
2. åœ¨GitHub Issuesä¸­æé—®
3. å¯»æ±‚ç¤¾åŒºå¸®åŠ©

---

**çŽ°åœ¨å°±å¼€å§‹å§ï¼é€‰æ‹©æœ€é€‚åˆæ‚¨çš„æ–¹æ¡ˆå¼€å§‹å…è´¹éƒ¨ç½²ï¼** ðŸš€
